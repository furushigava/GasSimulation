# Физика симуляции

---
[← README](../README.md) | **Физика** | [Математика](mathematics.md) | [Реализация](implementation.md) | [Параметры](parameters.md) | [Графики](graphs.md)

---

## Содержание

- [Термодинамика](#термодинамика)
  - [Первый закон термодинамики](#первый-закон-термодинамики)
  - [Второй закон термодинамики](#второй-закон-термодинамики)
- [Статистическая физика](#статистическая-физика)
  - [Распределение Максвелла](#распределение-максвелла)
  - [Распределение Больцмана](#распределение-больцмана)
  - [Эргодическая гипотеза](#эргодическая-гипотеза)
- [Молекулярная кинетика](#молекулярная-кинетика)
  - [Упругие столкновения](#упругие-столкновения)
  - [Степени свободы](#степени-свободы)
  - [Броуновское движение](#броуновское-движение)
- [Потенциалы взаимодействия](#потенциалы-взаимодействия)
  - [Потенциал Леннард-Джонса](#потенциал-леннард-джонса)
  - [Потенциал Морзе](#потенциал-морзе)
  - [Потенциал DLVO](#потенциал-dlvo)

---

## Термодинамика

### Первый закон термодинамики

**Закон сохранения энергии** — полная энергия изолированной системы остаётся постоянной.

В симуляции полная энергия системы складывается из:

- **Кинетическая энергия поступательного движения** — энергия движения центра масс частиц
- **Кинетическая энергия вращательного движения** — энергия вращения молекул (для многоатомных)
- **Потенциальная энергия взаимодействия** — энергия межмолекулярных сил (при включённых потенциалах)
- **Потенциальная энергия в поле тяжести** — энергия положения в гравитационном поле (при включённой гравитации)

**Верификация**: в режиме изолированной системы относительное отклонение полной энергии от начального значения должно оставаться малым (< 1%).

### Второй закон термодинамики

**Закон возрастания энтропии** — энтропия изолированной системы не убывает со временем.

Симуляция демонстрирует этот закон через:

1. **Рост энтропии** — при начальном размещении частиц в углу контейнера энтропия монотонно возрастает до максимального значения
2. **H-теорема Больцмана** — H-функция (отрицательная энтропия в пространстве скоростей) монотонно убывает

**Физический смысл**: система самопроизвольно эволюционирует от менее вероятных состояний к более вероятным (равновесным).

---

## Статистическая физика

### Распределение Максвелла

**Распределение Максвелла** описывает вероятность обнаружить молекулу с данной скоростью в равновесном идеальном газе.

В 2D-случае (который реализован в симуляции) распределение имеет вид:

```math
f(v) = \frac{mv}{k_B T} \exp\left(-\frac{mv^2}{2k_B T}\right)
```

где:
- $v$ — модуль скорости
- $m$ — масса молекулы  
- $k_B$ — постоянная Больцмана
- $T$ — температура

**Характерные скорости**:
- Наиболее вероятная: $v_p = \sqrt{k_B T / m}$
- Средняя: $\langle v \rangle = \sqrt{\pi k_B T / 2m}$
- Среднеквадратичная: $v_{rms} = \sqrt{2k_B T / m}$

**Верификация**: распределение скоростей частиц проверяется с помощью статистических тестов χ² и Колмогорова-Смирнова.

### Распределение Больцмана

**Барометрическая формула** описывает распределение концентрации газа по высоте в поле тяжести:

```math
\rho(h) = \rho_0 \exp\left(-\frac{mgh}{k_B T}\right)
```

где:
- $h$ — высота
- $g$ — ускорение свободного падения
- $\rho_0$ — концентрация на нулевой высоте

**Физический смысл**: плотность газа экспоненциально убывает с высотой. Характерная высота $H = k_B T / mg$ определяет масштаб убывания.

**Верификация**: при включённой гравитации распределение частиц по высоте должно соответствовать экспоненциальному закону.

### Эргодическая гипотеза

**Эргодическая гипотеза** утверждает, что временно́е среднее физической величины равно ансамблевому среднему:

```math
\langle A \rangle_t = \langle A \rangle_{ens}
```

Это означает, что за достаточно долгое время система проходит через все доступные микросостояния.

**Проявления в симуляции**:
1. Временны́е средние сходятся к ансамблевым
2. Система «забывает» начальные условия
3. Автокорреляционная функция затухает со временем

**Верификация**: сравнение временны́х средних (для одной частицы) с мгновенными ансамблевыми средними (по всем частицам).

---

## Молекулярная кинетика

### Упругие столкновения

При **упругом столкновении** сохраняются:
- Полный импульс системы
- Полная кинетическая энергия

**Столкновение со стенкой**: компонента скорости, перпендикулярная стенке, меняет знак.

**Столкновение двух частиц**: скорости пересчитываются в системе центра масс, затем переводятся обратно в лабораторную систему.

Для многоатомных молекул при столкновении также происходит обмен угловым моментом, что приводит к изменению угловых скоростей.

### Степени свободы

**Теорема о равнораспределении**: на каждую степень свободы приходится средняя энергия $k_B T / 2$.

| Тип молекулы | Поступательные | Вращательные (2D) | Всего |
|--------------|----------------|-------------------|-------|
| Одноатомная  | 2              | 0                 | 2     |
| Двухатомная  | 2              | 1                 | 3     |
| Многоатомная | 2              | 1                 | 3     |

**Примечание**: в 2D-симуляции вращение возможно только вокруг оси, перпендикулярной плоскости движения.

### Броуновское движение

**Броуновское движение** — хаотичное движение крупной частицы под действием ударов молекул окружающей среды.

**Соотношение Эйнштейна** для среднеквадратичного смещения:

```math
\langle r^2 \rangle = 2nDt
```

где:
- $n = 2$ для двумерного случая
- $D$ — коэффициент диффузии
- $t$ — время

Коэффициент диффузии связан с температурой и вязкостью:

```math
D = \frac{k_B T}{4\pi\eta r}
```

**Верификация**: линейная зависимость MSD от времени, определение коэффициента диффузии из наклона.

---

## Потенциалы взаимодействия

Симуляция поддерживает три типа межмолекулярных потенциалов.

### Потенциал Леннард-Джонса

**Потенциал Леннард-Джонса (12-6)** — классическая модель ван-дер-ваальсовых взаимодействий:

```math
U(r) = 4\varepsilon\left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right]
```

где:
- $\varepsilon$ — глубина потенциальной ямы (энергия связи)
- $\sigma$ — расстояние, на котором потенциал равен нулю
- Член $r^{-12}$ — короткодействующее отталкивание (перекрытие электронных оболочек)
- Член $r^{-6}$ — дальнодействующее притяжение (дисперсионные силы)

**Минимум потенциала**: $r_{min} = 2^{1/6}\sigma \approx 1.12\sigma$

**Применение**: благородные газы, неполярные молекулы.

### Потенциал Морзе

**Потенциал Морзе** — модель для описания химической связи:

```math
U(r) = D_e\left[1 - e^{-a(r-r_e)}\right]^2
```

где:
- $D_e$ — энергия диссоциации (глубина ямы)
- $a$ — параметр «жёсткости» связи
- $r_e$ — равновесное расстояние

**Особенности**:
- Асимметричная форма (в отличие от гармонического осциллятора)
- Правильно описывает диссоциацию при больших расстояниях
- Используется для моделирования двухатомных молекул

### Потенциал DLVO

**Потенциал DLVO** (Дерягина-Ландау-Вервея-Овербека) описывает взаимодействие коллоидных частиц:

```math
U(r) = U_{vdW}(r) + U_{el}(r)
```

Включает два вклада:

1. **Ван-дер-ваальсово притяжение**:
```math
U_{vdW} = -\frac{A}{12}\frac{R_1 R_2}{(R_1 + R_2)}\frac{1}{h}
```

2. **Электростатическое отталкивание**:
```math
U_{el} = 2\pi\varepsilon_0\varepsilon_r R \psi^2 \ln(1 + e^{-\kappa h})
```

где:
- $A$ — константа Гамакера
- $\psi$ — поверхностный потенциал
- $\kappa$ — обратная длина Дебая (параметр экранирования)
- $\varepsilon_r$ — относительная диэлектрическая проницаемость
- $h$ — расстояние между поверхностями

**Применение**: коллоидные растворы, взаимодействие наночастиц.

---

[← README](../README.md) | **Физика** | [Математика](mathematics.md) | [Реализация](implementation.md) | [Параметры](parameters.md) | [Графики](graphs.md)
