# Математические модели

---
[← README](../README.md) | [Физика](physics.md) | **Математика** | [Реализация](implementation.md) | [Параметры](parameters.md) | [Графики](graphs.md)

---

## Содержание

- [Статистические распределения](#статистические-распределения)
  - [Распределение Максвелла (2D)](#распределение-максвелла-2d)
  - [Барометрическая формула](#барометрическая-формула)
- [Механика столкновений](#механика-столкновений)
  - [Столкновение со стенкой](#столкновение-со-стенкой)
  - [Столкновение двух частиц](#столкновение-двух-частиц)
  - [Передача углового момента](#передача-углового-момента)
- [Энергетические расчёты](#энергетические-расчёты)
  - [Кинетическая энергия](#кинетическая-энергия)
  - [Потенциальная энергия](#потенциальная-энергия)
  - [Температура](#температура)
- [Расчёт энтропии](#расчёт-энтропии)
  - [Энтропия по скоростям](#энтропия-по-скоростям)
  - [Пространственная энтропия](#пространственная-энтропия)
  - [H-функция Больцмана](#h-функция-больцмана)
- [Давление](#давление)
- [Броуновское движение](#броуновское-движение)
  - [Среднеквадратичное смещение](#среднеквадратичное-смещение)
  - [Коэффициент диффузии](#коэффициент-диффузии)
- [Потенциалы взаимодействия](#потенциалы-взаимодействия)
  - [Леннард-Джонс](#леннард-джонс)
  - [Морзе](#морзе)
  - [DLVO](#dlvo)
- [Статистические тесты](#статистические-тесты)
  - [Критерий χ² (хи-квадрат)](#критерий-χ²-хи-квадрат)
  - [Критерий Колмогорова-Смирнова](#критерий-колмогорова-смирнова)

---

## Статистические распределения

### Распределение Максвелла (2D)

Функция распределения молекул по модулю скорости в двумерном случае:

```math
f(v) = \frac{mv}{k_B T} \exp\left(-\frac{mv^2}{2k_B T}\right)
```

**Характерные скорости**:

| Величина | Формула | Описание |
|----------|---------|----------|
| Наиболее вероятная | $v_p = \sqrt{\dfrac{k_B T}{m}}$ | Максимум распределения |
| Средняя | $\langle v \rangle = \sqrt{\dfrac{\pi k_B T}{2m}}$ | Математическое ожидание |
| Среднеквадратичная | $v_{rms} = \sqrt{\dfrac{2k_B T}{m}}$ | Корень из среднего квадрата |

**Нормировка**: 
```math
\int_0^\infty f(v) \, dv = 1
```

**Средняя кинетическая энергия** (в 2D):
```math
\langle E_k \rangle = k_B T
```

### Барометрическая формула

Распределение концентрации частиц по высоте в поле тяжести:

```math
n(h) = n_0 \exp\left(-\frac{mgh}{k_B T}\right)
```

**Характерная высота** (высота однородной атмосферы):
```math
H = \frac{k_B T}{mg}
```

На высоте $H$ концентрация уменьшается в $e \approx 2.718$ раз.

---

## Механика столкновений

### Столкновение со стенкой

При упругом отражении от вертикальной стенки:
```math
v_x \rightarrow -v_x, \quad v_y \rightarrow v_y
```

При упругом отражении от горизонтальной стенки:
```math
v_x \rightarrow v_x, \quad v_y \rightarrow -v_y
```

**Переданный импульс** стенке (для расчёта давления):
```math
\Delta p = 2m|v_n|
```
где $v_n$ — нормальная компонента скорости.

### Столкновение двух частиц

Для двух частиц с массами $m_1$ и $m_2$ при упругом столкновении.

**Условие столкновения**: расстояние между центрами меньше суммы радиусов:
```math
|\vec{r}_1 - \vec{r}_2| < R_1 + R_2
```

**Алгоритм расчёта**:

1. Вектор соединения центров:
```math
\vec{n} = \frac{\vec{r}_1 - \vec{r}_2}{|\vec{r}_1 - \vec{r}_2|}
```

2. Проекции скоростей на линию столкновения:
```math
v_{1n} = \vec{v}_1 \cdot \vec{n}, \quad v_{2n} = \vec{v}_2 \cdot \vec{n}
```

3. Новые проекции после столкновения:
```math
v'_{1n} = \frac{(m_1 - m_2)v_{1n} + 2m_2 v_{2n}}{m_1 + m_2}
```
```math
v'_{2n} = \frac{(m_2 - m_1)v_{2n} + 2m_1 v_{1n}}{m_1 + m_2}
```

4. Обновление скоростей:
```math
\vec{v}'_1 = \vec{v}_1 + (v'_{1n} - v_{1n})\vec{n}
```
```math
\vec{v}'_2 = \vec{v}_2 + (v'_{2n} - v_{2n})\vec{n}
```

### Передача углового момента

При столкновении многоатомных молекул происходит обмен угловым моментом.

**Момент силы** при ударе:
```math
\tau = R \cdot F_t
```
где $F_t$ — тангенциальная компонента силы удара.

**Изменение угловой скорости**:
```math
\Delta\omega = \frac{\tau \cdot \Delta t}{I}
```
где $I$ — момент инерции молекулы.

---

## Энергетические расчёты

### Кинетическая энергия

**Поступательная кинетическая энергия** частицы:
```math
E_{trans} = \frac{1}{2}mv^2 = \frac{1}{2}m(v_x^2 + v_y^2)
```

**Вращательная кинетическая энергия** (для многоатомных молекул):
```math
E_{rot} = \frac{1}{2}I\omega^2
```

**Полная кинетическая энергия** молекулы:
```math
E_k = E_{trans} + E_{rot}
```

**Полная кинетическая энергия системы**:
```math
E_k^{total} = \sum_{i=1}^{N} \left(\frac{1}{2}m_i v_i^2 + \frac{1}{2}I_i\omega_i^2\right)
```

### Потенциальная энергия

**В поле тяжести**:
```math
E_{grav} = mgh
```

**Межмолекулярная** (при включённых потенциалах):
```math
E_{pot} = \sum_{i<j} U(r_{ij})
```
где суммирование по всем парам частиц.

**Полная энергия системы**:
```math
E_{total} = E_k^{total} + E_{pot} + E_{grav}
```

### Температура

Температура определяется через среднюю кинетическую энергию по теореме о равнораспределении.

**Для 2D системы без вращения** (2 степени свободы):
```math
T = \frac{m\langle v^2 \rangle}{2k_B} = \frac{\langle E_{trans} \rangle}{k_B}
```

**Для 2D системы с вращением** (3 степени свободы):
```math
T = \frac{2}{3} \cdot \frac{\langle E_{trans} \rangle + \langle E_{rot} \rangle}{k_B}
```

---

## Расчёт энтропии

### Энтропия по скоростям

Дискретная энтропия по распределению скоростей:

```math
S_v = -k_B \sum_{i} p_i \ln(p_i)
```

где $p_i$ — доля частиц в $i$-м интервале скоростей.

**Алгоритм**:
1. Разбить диапазон скоростей на $N_{bins}$ интервалов
2. Подсчитать количество частиц в каждом интервале
3. Вычислить вероятности $p_i = n_i / N$
4. Вычислить сумму $-\sum p_i \ln(p_i)$

### Пространственная энтропия

Дискретная энтропия по распределению в пространстве:

```math
S_{space} = -k_B \sum_{i,j} p_{ij} \ln(p_{ij})
```

где $p_{ij}$ — доля частиц в ячейке $(i, j)$ пространственной сетки.

**Алгоритм**:
1. Разбить контейнер на сетку $N_x \times N_y$ ячеек
2. Подсчитать количество частиц в каждой ячейке
3. Вычислить вероятности $p_{ij} = n_{ij} / N$
4. Вычислить двойную сумму

### H-функция Больцмана

H-функция определяется как:

```math
H = \int f(\vec{v}) \ln(f(\vec{v})) \, d\vec{v}
```

**Дискретная версия**:
```math
H = \sum_{i} f_i \ln(f_i) \cdot \Delta v
```

**H-теорема**: $dH/dt \leq 0$ (H-функция не возрастает).

**Связь с энтропией**: $S = -k_B H$

---

## Давление

Давление рассчитывается из переданного импульса стенкам.

**Импульс, переданный стенке за время $\Delta t$**:
```math
\Delta p_x = \sum_{collisions} 2m|v_x|
```

**Давление на вертикальную стенку**:
```math
P_x = \frac{\Delta p_x}{L_y \cdot \Delta t}
```

**Среднее давление**:
```math
P = \frac{1}{2}\left(\frac{\Delta p_x}{L_y \Delta t} + \frac{\Delta p_y}{L_x \Delta t}\right)
```

**Идеальный газ** (проверка):
```math
PV = Nk_B T
```

---

## Броуновское движение

### Среднеквадратичное смещение

**MSD (Mean Square Displacement)** — среднеквадратичное смещение:

```math
\langle r^2(t) \rangle = \langle |\vec{r}(t) - \vec{r}(0)|^2 \rangle
```

**Соотношение Эйнштейна** (для диффузии):
```math
\langle r^2 \rangle = 2nDt
```

где:
- $n = 2$ для двумерного случая
- $D$ — коэффициент диффузии
- $t$ — время

### Коэффициент диффузии

**Формула Стокса-Эйнштейна** (2D):
```math
D = \frac{k_B T}{4\pi\eta R}
```

где:
- $\eta$ — динамическая вязкость среды
- $R$ — радиус броуновской частицы

**Определение из симуляции**:
```math
D = \frac{1}{4} \cdot \frac{d\langle r^2 \rangle}{dt}
```

---

## Потенциалы взаимодействия

### Леннард-Джонс

**Потенциальная энергия**:
```math
U(r) = 4\varepsilon\left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right]
```

**Сила взаимодействия** (отрицательный градиент потенциала):
```math
F(r) = -\frac{dU}{dr} = \frac{24\varepsilon}{r}\left[2\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right]
```

**Положение минимума**: $r_{min} = 2^{1/6}\sigma$

**Радиус обрезания**: обычно $r_c = 2.5\sigma$. При $r > r_c$ взаимодействие не учитывается.

### Морзе

**Потенциальная энергия**:
```math
U(r) = D_e\left[1 - e^{-a(r-r_e)}\right]^2
```

**Сила взаимодействия**:
```math
F(r) = 2aD_e\left[1 - e^{-a(r-r_e)}\right]e^{-a(r-r_e)}
```

**Частота малых колебаний**:
```math
\omega = a\sqrt{\frac{2D_e}{\mu}}
```
где $\mu$ — приведённая масса.

### DLVO

**Ван-дер-ваальсово притяжение** (приближение Дерягина):
```math
U_{vdW}(h) = -\frac{A}{12h} \cdot \frac{R_1 R_2}{R_1 + R_2}
```

где $h = r - R_1 - R_2$ — расстояние между поверхностями.

**Электростатическое отталкивание**:
```math
U_{el}(h) = 2\pi\varepsilon_0\varepsilon_r R_{eff} \psi^2 \ln(1 + e^{-\kappa h})
```

где:
- $R_{eff} = R_1 R_2 / (R_1 + R_2)$ — эффективный радиус
- $\kappa$ — обратная длина Дебая

**Полный потенциал DLVO**:
```math
U_{DLVO}(h) = U_{vdW}(h) + U_{el}(h)
```

---

## Статистические тесты

### Критерий χ² (хи-квадрат)

Проверка согласия экспериментального распределения с теоретическим.

**Статистика χ²**:
```math
\chi^2 = \sum_{i=1}^{k} \frac{(O_i - E_i)^2}{E_i}
```

где:
- $O_i$ — наблюдаемое количество в $i$-м интервале
- $E_i$ — ожидаемое (теоретическое) количество
- $k$ — число интервалов

**Число степеней свободы**: $\nu = k - 1 - m$, где $m$ — число оцениваемых параметров.

**Интерпретация**: если $\chi^2 < \chi^2_{crit}(\alpha, \nu)$, гипотеза о согласии не отвергается на уровне значимости $\alpha$.

### Критерий Колмогорова-Смирнова

Непараметрический критерий согласия, основанный на максимальном отклонении эмпирической функции распределения от теоретической.

**Статистика KS**:
```math
D_n = \sup_x |F_n(x) - F(x)|
```

где:
- $F_n(x)$ — эмпирическая функция распределения
- $F(x)$ — теоретическая функция распределения

**Критическое значение** (приближённо для больших $n$):
```math
D_{crit} \approx \frac{c(\alpha)}{\sqrt{n}}
```

где $c(\alpha)$ зависит от уровня значимости.

**Преимущества**: не требует разбиения на интервалы, работает с непрерывными распределениями.

---

[← README](../README.md) | [Физика](physics.md) | **Математика** | [Реализация](implementation.md) | [Параметры](parameters.md) | [Графики](graphs.md)
